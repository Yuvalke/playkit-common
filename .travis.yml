conditions: v1
sudo: required
dist: xenial
language: node_js
node_js:
  - "node"

addons:
  chrome: stable

services:
  - xvfb
cache:
  yarn: true
  directories:
    - node_modules

before_install:
  - export DISPLAY=:99.0

script:
  - set -ev
  - yarn install

stages:
  - Release

jobs:
  fast_finish: true
  include:
    # https://docs.travis-ci.com/user/build-stages/deploy-github-releases/
    - stage: Release
      name: "Releasing a new version"
      if: tag IS present
      before_deploy:
        - conventional-github-releaser -t $GH_NOTE_TOKEN
      deploy:
        - provider: releases
          api_key: $GH_NOTE_TOKEN
          file_glob: true
          file: dist/*
          prerelease: true
          skip_cleanup: true
          on:
            branch: master
            tags: true
