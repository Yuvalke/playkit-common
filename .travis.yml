conditions: v1
sudo: required
dist: xenial
language: node_js
node_js:
  - "node"

addons:
  chrome: stable

services:
  - xvfb
cache:
  yarn: true
  directories:
    - node_modules

before_install:
  - export DISPLAY=:99.0
  - chmod +x ./travis.sh

script:
  - yarn install
  - bash ./travis.sh

stages:
  - Release canary
  - Release
jobs:
  fast_finish: true
  include:
    # https://docs.travis-ci.com/user/build-stages/deploy-github-releases/
    - stage: Release
      name: 'Releasing a new version'
      if: tag IS present
      env: TRAVIS_MODE=release
      deploy:
        - provider: script
          on:
            tags: true
            all_branches: true
          script: bash ./travis.sh

